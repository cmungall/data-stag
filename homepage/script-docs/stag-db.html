<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>stag-db</title>
<link rev="made" href="mailto:feedback@suse.de" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#arguments">ARGUMENTS</a></li>
		<ul>

			<li><a href="#i_indexfile">-i INDEXFILE</a></li>
			<li><a href="#r_relationname">-r RELATION-NAME</a></li>
			<li><a href="#k_uniquekey">-k UNIQUE-KEY</a></li>
			<li><a href="#u_uniquekey">-u UNIQUE-KEY</a></li>
			<li><a href="#p_parser">-p PARSER</a></li>
			<li><a href="#q_queryid">-q QUERY-ID</a></li>
			<li><a href="#top_nodename">-top NODE-NAME</a></li>
			<li><a href="#qf_queryfile">-qf QUERY-FILE</a></li>
			<li><a href="#keys">-keys</a></li>
			<li><a href="#w_writer">-w WRITER</a></li>
		</ul>

	</ul>

	<li><a href="#see_also">SEE ALSO</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>stag-db.pl - persistent storage and retrieval for stag data (xml, sxpr, itext)</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
  stag-db.pl -r person -k social_security_no -i ./person-idx myrecords.xml
  stag-db.pl -i ./person-idx -q 999-9999-9999 -q 888-8888-8888</pre>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Builds a simple file-based database for persistent storage and
retrieval of nodes from a stag compatible document.</p>
<p>Imagine you have a very large file of data, in a stag compatible
format such as XML. You want to index all the elements of type
<strong>person</strong>; each person can be uniquely identified by
<strong>social_security_no</strong>, which is a direct subnode of <strong>person</strong></p>
<p>The first thing to do is to build an index file, which will be stored
in your current directory:</p>
<pre>
  stag-db.pl -r person -k social_security_no -i ./person-idx myrecords.xml</pre>
<p>You can then use the index ``person-idx'' to retrieve <strong>person</strong> nodes by
their social security number</p>
<pre>
  stag-db.pl -i ./person-idx -q 999-9999-9999 &gt; some-person.xml</pre>
<p>You can export using different stag formats</p>
<pre>
  stag-db.pl -i ./person-idx -q 999-9999-9999 -w sxpr &gt; some-person.xml</pre>
<p>You can retrieve multiple nodes (although these need to be rooted to
make a valid file)</p>
<pre>
  stag-db.pl -i ./person-idx -q 999-9999-9999 -q 888-8888-8888 -top personset</pre>
<p>Or you can use a list of IDs from a file (newline delimited)</p>
<pre>
  stag-db.pl -i ./person-idx -qf my_ss_nmbrs.txt -top personset</pre>
<p>
</p>
<h2><a name="arguments">ARGUMENTS</a></h2>
<p>
</p>
<h3><a name="i_indexfile">-i INDEXFILE</a></h3>
<p>This file will be used as the persistent index for storage/retrieval</p>
<p>
</p>
<h3><a name="r_relationname">-r RELATION-NAME</a></h3>
<p>This is the name of the stag node (XML element) that will be stored in
the index; for example, with the XML below you may want to use the
node name <strong>person</strong> and the unique key <strong>id</strong></p>
<pre>
  &lt;person_set&gt;
    &lt;person&gt;
      &lt;id&gt;...&lt;/id&gt;
    &lt;/person&gt;
    &lt;person&gt;
      &lt;id&gt;...&lt;/id&gt;
    &lt;/person&gt;
    ...
  &lt;/person_set&gt;</pre>
<p>This flag should only be used when you want to store data</p>
<p>
</p>
<h3><a name="k_uniquekey">-k UNIQUE-KEY</a></h3>
<p>This node will be used as the unique/primary key for the data</p>
<p>This node should be nested directly below the node that is being
stored in the index - if it is more that one below, specify a path</p>
<p>This flag should only be used when you want to store data</p>
<p>
</p>
<h3><a name="u_uniquekey">-u UNIQUE-KEY</a></h3>
<p>Synonym for <strong>-k</strong></p>
<p>
</p>
<h3><a name="p_parser">-p PARSER</a></h3>
<p>This can be the name of a stag supported format (xml, sxpr, itext) -
XML is assumed by default</p>
<p>It can also be a module name - this module is used to parse the input
file into a stag stream; see <a href="./Data/Stag/BaseGenerator.html">the Data::Stag::BaseGenerator manpage</a> for details
on writing your own parsers/event generators</p>
<p>This flag should only be used when you want to store data</p>
<p>
</p>
<h3><a name="q_queryid">-q QUERY-ID</a></h3>
<p>Fetches the relation/node with unique key value equal to query-id</p>
<p>Multiple arguments can be passed by specifying -q multple times</p>
<p>This flag should only be used when you want to query data</p>
<p>
</p>
<h3><a name="top_nodename">-top NODE-NAME</a></h3>
<p>If this is specified in conjunction with <strong>-q</strong> or <strong>-qf</strong> then all the
query result nodes will be nested inside a node with this name (ie
this provides a root for the resulting document tree)</p>
<p>
</p>
<h3><a name="qf_queryfile">-qf QUERY-FILE</a></h3>
<p>This is a file of newline-seperated IDs; this is useful for querying
the index in batch</p>
<p>
</p>
<h3><a name="keys">-keys</a></h3>
<p>This will write a list of all primary keys in the index</p>
<p>
</p>
<h3><a name="w_writer">-w WRITER</a></h3>
<p>This format will be used to write the data; can be any stag format
(xml, sxpr, itext) - default XML.</p>
<p>Can also be a module that catches the incoming stag event stream and
does something with it (for example, this could be a module you write
yourself that transforms the stag events into HTML)</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p><a href="./Data/Stag.html">the Data::Stag manpage</a></p>
<p>For more complex stag to database mapping, see <a href="./DBIx/DBStag.html">the DBIx::DBStag manpage</a> and the
scripts</p>
<p><em>stag-storenode.pl</em></p>
<p><em>selectall_xml</em></p>

</body>

</html>
